<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Patient Dashboard</title>
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">

<style>
/* ===== Global Styles ===== */
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: skyblue;
  color: #333;
  line-height: 1.6;
}

/* ===== Header ===== */
header{
  background: linear-gradient(135deg,#4a90e2,#007bff);
  color:#fff;
  text-align:center;
  padding:30px 0 20px;
  box-shadow:0 4px 10px rgba(0,0,0,0.15);
}
header h1{ margin:0; font-size:30px; font-weight:700; letter-spacing:0.5px; }

/* ===== Navigation Bar ===== */
.navbar{
  background:#fff; display:flex; justify-content:center; gap:50px;
  padding:16px 0; box-shadow:0 2px 10px rgba(0,0,0,0.05); position:sticky; top:0; z-index:100;
}
.navbar a{
  text-decoration:none; color:#2b6ee6; font-weight:600; font-size:16px;
  display:flex; align-items:center; gap:6px; transition:0.25s;
}
.navbar a:hover{ color:#1d4ed8; transform:scale(1.05); }

/* ===== Container ===== */
.container{
  max-width:1200px; margin:40px auto; background:#fff; padding:35px; border-radius:14px;
  box-shadow:0 5px 25px rgba(0,0,0,0.08); animation:fadeUp .45s ease;
}
@keyframes fadeUp { from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }

/* ===== Controls ===== */
/* ===== Controls ===== */
a.add-btn{
  display:inline-block;
  background:linear-gradient(135deg,#28a745,#218838);
  color:#fff;
  font-weight:600;
  padding:12px 22px;
  border-radius:8px;
  text-decoration:none;
  margin-bottom:8px;   /* ðŸ”§ reduced from 20px */
}

.search-bar{
  display:flex;
  justify-content:flex-end;
  align-items:center;
  margin-bottom:15px;  /* ðŸ”§ reduced from 25px */
  gap:12px;
}

.search-bar input{
  width:300px; padding:10px 14px; border:1px solid #cfd8e3; border-radius:8px; outline:none; font-size:14px;
}
.search-bar input:focus{ border-color:#4a90e2; box-shadow:0 0 8px rgba(74,144,226,0.2); }

/* ===== Desktop Table Styles ===== */
table{ width:100%; border-collapse:collapse; border-radius:12px; box-shadow:0 3px 10px rgba(0,0,0,0.05); }
thead{ background: linear-gradient(135deg,#4a90e2,#007bff); color:#fff; }
th, td{ text-align:left; padding:14px 16px; font-size:15px; vertical-align:middle; }
th{ font-weight:600; letter-spacing:0.5px; }
/* Sticky table header + vertical align fix */
thead th {
    position: sticky;
    top: 0;
    background: linear-gradient(135deg,#4a90e2,#007bff);
    z-index: 5;
    text-align: center !important;
    vertical-align: middle !important;
    padding-top: 16px !important;
    padding-bottom: 16px !important;
}

th {
    text-align: center !important;
    vertical-align: middle !important;
}

tr:nth-child(even){ background:#f7faff; }
tr:hover{ background:#e8f0ff; transition:0.15s ease; }

/* Action buttons */
a.edit-btn, a.delete-btn{
  display:inline-flex; align-items:center; justify-content:center; gap:6px;
  padding:7px 12px; border-radius:6px; color:#fff; text-decoration:none; font-size:14px; font-weight:500;
}
a.edit-btn{ background:#ff9800; }
a.edit-btn:hover{ background:#e68900; }
a.delete-btn{ background:#dc3545; }
a.delete-btn:hover{ background:#b02a37; }

/* Table wrapper (fix overflow) */
.table-wrapper {
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}
.table-wrapper table {
    min-width: 850px;
}

/* Message box */
.message-box{ padding:15px 20px; border-radius:8px; margin-bottom:20px; font-weight:500; color:white; box-shadow:0 3px 8px rgba(0,0,0,0.2); animation:fadeInOut 3s forwards; }
.message-box.success{ background:#28a745; }
.message-box.error{ background:#dc3545; }
.message-box.warning{ background:#ffc107; color:#333; }
@keyframes fadeInOut{ 0%{opacity:0;transform:translateY(-20px)} 10%,90%{opacity:1;transform:none} 100%{opacity:0;transform:translateY(-20px)} }

/* Remove desktop before labels */
td::before {
    content: none !important;
}

/* =========================================
   MOBILE VIEW (Vertical Cards)
   ========================================= */
@media (max-width: 600px) {

  table { 
    display:block; 
    width:100%; 
    border:0; 
    box-shadow:none; 
    background:transparent; 
  }
  thead { display:none; }
  tbody { display:block; }

  tr {
    display:block;
    background:#fff;
    margin-bottom:14px;
    padding:12px;
    border-radius:10px;
    box-shadow:0 2px 8px rgba(0,0,0,0.08);
  }

  td {
    display:flex !important;                 /* FIXED */
    flex-direction:row;
    justify-content:flex-start;
    align-items:center !important;           /* FIXED */
    gap:6px;
    padding:10px 8px;
    border-bottom:1px solid #f0f0f0;
    font-size:15px;
  }

  td:last-child { border-bottom:none; }

  td::before {
    content: attr(data-label) ": " !important;
    font-weight:700;
    color:#007bff;
    margin-right:6px;
    display:inline-block !important;
    align-self:center !important;            /* FIXED */
  }

  td > .cell-value {
    display:inline;
    word-break:break-word;
  }

  /* Align actions properly */
  td[data-label="Actions"] {
    display:flex;
    justify-content:left !important;
    align-items:left !important;
    gap:12px;
  }

}
/* 100% FIX â€” NAVBAR VERTICAL ONLY IN MOBILE */
@media (max-width: 600px) {

    .navbar {
        display: flex !important;
        flex-direction: column !important;
        gap: 15px !important;
        padding: 15px 0 !important;
        align-items: center !important;
        justify-content: center !important;
    }

    .navbar a {
        width: 90% !important;
        justify-content: center !important;
        padding: 12px 0 !important;
        background: #ffffff !important;
        border-radius: 10px !important;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08) !important;
        font-size: 16px !important;
    }
}

/* REMOVE your previous wrong code */
/* Fix Action Column Alignment */
table td:last-child,
table th:last-child {
    text-align: center !important;
    padding-right: 0 !important;
}


</style>
</head>
<body>
<header>
  <h1>Patient Dashboard</h1>
</header>

<nav class="navbar">
  <a href="{% url 'dashboard' %}"><i class='bx bx-home'></i> Dashboard</a>
  <a href="{% url 'add_appointment' %}"><i class='bx bx-calendar-plus'></i> Add Appointment</a>
  <a href="{% url 'add_patient' %}"><i class='bx bx-user-plus'></i> Add Patient</a>
  <a href="{% url 'report' %}"><i class='bx bxs-report'></i> Reports</a>
  <a href="/admin/logout/"><i class='bx bx-log-out'></i> Logout</a>
</nav>

<div class="container">

  {% if messages %}
      {% for message in messages %}
          <div class="message-box {% if message.tags %}{{ message.tags }}{% endif %}">
              {{ message }}
          </div>
      {% endfor %}
  {% endif %}

  <a href="{% url 'add_patient' %}" class="add-btn"><i class='bx bx-plus'></i> Add Patient</a>

  <div class="search-bar">
    <i class='bx bx-search'></i>
    <input type="text" id="searchInput" placeholder="Search patients by name, ID, or contact...">
  </div>

  <div class="table-wrapper">
  <table id="patientTable">
    <thead>
      <tr>
        <th>ID</th><th>Name</th><th>Age</th><th>Gender</th><th>Contact</th>
        <th>Medical History</th><th>Allergies</th><th>Medications</th><th>Actions</th>
      </tr>
    </thead>
    <tbody>

      {% for patient in patients %}
      <tr>
        <td data-label="ID"><span class="cell-value">{{ patient.id }}</span></td>
        <td data-label="Name"><span class="cell-value">{{ patient.name }}</span></td>
        <td data-label="Age"><span class="cell-value">{{ patient.age }}</span></td>
        <td data-label="Gender"><span class="cell-value">{{ patient.gender }}</span></td>
        <td data-label="Contact"><span class="cell-value">{{ patient.contact }}</span></td>
        <td data-label="Medical History"><span class="cell-value">{{ patient.medical_history }}</span></td>
        <td data-label="Allergies"><span class="cell-value">{{ patient.allergies }}</span></td>
        <td data-label="Medications"><span class="cell-value">{{ patient.medications }}</span></td>
        <td data-label="Actions">
          <a href="{% url 'edit_patient' patient.id %}" class="edit-btn"><i class='bx bx-edit'></i></a>
          <a href="{% url 'delete_patient' patient.id %}" class="delete-btn" onclick="return confirm('Are you sure?');"><i class='bx bx-trash'></i></a>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="9" style="text-align:center;color:#666;">No patients found.</td>
      </tr>
      {% endfor %}

    </tbody>
  </table>
</div>
</div>

<script>
document.getElementById("searchInput").addEventListener("keyup", function() {
  let input = this.value.toLowerCase();
  document.querySelectorAll("#patientTable tbody tr").forEach(row => {
    row.style.display = row.textContent.toLowerCase().includes(input) ? "" : "none";
  });
});
</script>
</body>
</html>
